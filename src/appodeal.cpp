#include <assert.h>#include <stdlib.h>#include <stdio.h>#include <unistd.h>#include <dmsdk/extension/extension.h>#include <dmsdk/script/script.h>  #include <dmsdk/dlib/log.h>#include "appodeal_private.h"// Extension lib defines#define LIB_NAME "Appodeal"#define MODULE_NAME "appodeal"//custom listener for callbacksstatic int Listen(lua_State* L) {    Appodeal_Listen(L);    return 0;}//common SDK methodsstatic int Init(lua_State* L) {    Appodeal_Initialise(L);    return 0;}static int HideBanner(lua_State* L) {    Appodeal_HideBanner(L);    return 0;}static int Show(lua_State* L) {    Appodeal_ShowAd(L);    return 0;}static int DisableNetwork(lua_State* L) {    Appodeal_DisableNetwork(L);    return 0;}static int SetLocationTracking(lua_State* L) {    Appodeal_SetLocationTracking(L);    return 0;}static int SetAutocache(lua_State* L) {    Appodeal_SetAutocache(L);    return 0;}static int CacheAd(lua_State* L) {    Appodeal_CacheAd(L);    return 0;}static int SetDebugEnabled(lua_State* L) {    Appodeal_SetDebugEnabled(L);    return 0;}static int SetTestingEnabled(lua_State* L) {    Appodeal_SetTestingEnabled(L);    return 0;}//custom rulesstatic int SetCustomIntRule(lua_State* L) {    Appodeal_SetCustomIntRule(L);    return 0;}static int SetCustomBoolRule(lua_State* L) {    Appodeal_SetCustomBoolRule(L);    return 0;}static int SetCustomDoubleRule(lua_State* L) {    Appodeal_SetCustomDoubleRule(L);    return 0;}static int SetCustomStringRule(lua_State* L) {    Appodeal_SetCustomStringRule(L);    return 0;}//endof custom rulesstatic int ConfirmUsage(lua_State* L) {    Appodeal_ConfirmUsage(L);    return 0;}static int IsAutocacheEnabled(lua_State* L) {    return 0;}static int IsInitalized(lua_State* L) {    return 0;}static int IsReadyForShowWithStyle(lua_State* L) {    return 0;}static int SetSmartBannersEnabled(lua_State* L) {    Appodeal_SetSmartBannersEnabled(L);    return 0;}static int SetBannerBackgroundVisible(lua_State* L) {    Appodeal_SetBannerBackgroundVisible(L);    return 0;}static int SetBannerAnimationEnabled(lua_State* L) {    Appodeal_SetBannerAnimationEnabled(L);    return 0;}static int DisableUserDataForNetwork(lua_State* L) {    Appodeal_DisableUserDataForNetwork(L);    return 0;}//user settingsstatic int SetUserId(lua_State* L) {    Appodeal_SetUserId(L);    return 0;}static int SetUserEmail(lua_State* L) {    Appodeal_SetUserEmail(L);    return 0;}static int SetUserBirthday(lua_State* L) {    Appodeal_SetUserBirthday(L);    return 0;}static int SetUserAge(lua_State* L) {    Appodeal_SetUserAge(L);    return 0;}static int SetUserGender(lua_State* L) {    APDDefoldUserGender type = (APDDefoldUserGender) luaL_checkint(L, 1);            Appodeal_SetUserGender(type);    return 0;}static int SetUserOccupation(lua_State* L) {    APDDefoldUserOccupation type = (APDDefoldUserOccupation) luaL_checkint(L, 1);       Appodeal_SetUserOccupation(type);    return 0;}static int SetUserRelationship(lua_State* L) {    APDDefoldUserRelationship type = (APDDefoldUserRelationship) luaL_checkint(L, 1);       Appodeal_SetUserRelationship(type);    return 0;}static int SetUserSmokingAttitude(lua_State* L) {    APDDefoldUserSmokingAttitude type = (APDDefoldUserSmokingAttitude) luaL_checkint(L, 1);       Appodeal_SetUserSmokingAttitude(type);    return 0;}static int SetUserAlcoholAttitude(lua_State* L) {    APDDefoldUserAlcoholAttitude type = (APDDefoldUserAlcoholAttitude) luaL_checkint(L, 1);       Appodeal_SetUserAlcoholAttitude(type);    return 0;}static int SetUserInterests(lua_State* L) {    Appodeal_SetUserInterests(L);    return 0;}static const luaL_reg Module_methods[] = {  {"init", Init},  {"show", Show},  {"listen", Listen},  {"hideBanner", HideBanner},  {"disableNetwork", DisableNetwork},  {"setLocationTracking", SetLocationTracking},  {"setAutocache", SetAutocache},  {"cacheAd", CacheAd},  {"setDebugEnabled", SetDebugEnabled},  {"setTestingEnabled", SetTestingEnabled},  {"setCustomIntRule", SetCustomIntRule},  {"setCustomBoolRule", SetCustomBoolRule},  {"setCustomDoubleRule", SetCustomDoubleRule},  {"setCustomStringRule", SetCustomStringRule},  {"confirmUsage", ConfirmUsage},  {"isAutocacheEnabled", IsAutocacheEnabled},  {"isInitalized", IsInitalized},  {"isReadyForShowWithStyle", IsReadyForShowWithStyle},  {"setSmartBannersEnabled", SetSmartBannersEnabled},  {"setBannerBackgroundVisible", SetBannerBackgroundVisible},  {"setBannerAnimationEnabled", SetBannerAnimationEnabled},  {"disableUserDataForNetwork", DisableUserDataForNetwork},  {"setUserId", SetUserId},  {"setUserEmail", SetUserEmail},  {"setUserBirthday", SetUserBirthday},  {"setUserAge", SetUserAge},  {"setUserGender", SetUserGender},  {"setUserOccupation", SetUserOccupation},    {"setUserRelationship", SetUserRelationship},  {"setUserSmokingAttitude", SetUserSmokingAttitude},  {"setUserAlcoholAttitude", SetUserAlcoholAttitude},  {"setUserInterests", SetUserInterests},  {0, 0}};static void LuaInit(lua_State* L) {    int top = lua_gettop(L);    luaL_register(L, MODULE_NAME, Module_methods);#define SETCONSTANT(name) \    lua_pushnumber(L, (lua_Number) name); \    lua_setfield(L, -2, #name);\    SETCONSTANT(GENDER_OTHER)    SETCONSTANT(GENDER_FEMALE)	SETCONSTANT(GENDER_MALE)		SETCONSTANT(OCCUPATION_OTHER)    SETCONSTANT(OCCUPATION_WORK)	SETCONSTANT(OCCUPATION_SCHOOL)    SETCONSTANT(OCCUPATION_UNIVERSITY)        SETCONSTANT(RELATIONSHIP_OTHER)    SETCONSTANT(RELATIONSHIP_SINGLE)    SETCONSTANT(RELATIONSHIP_DATING)    SETCONSTANT(RELATIONSHIP_ENGAGED)	SETCONSTANT(RELATIONSHIP_MARRIED)	SETCONSTANT(RELATIONSHIP_SEARCHING)	    SETCONSTANT(SMOKING_NEGATIVE)	SETCONSTANT(SMOKING_NEUTRAL)	SETCONSTANT(SMOKING_POSITIVE)	    SETCONSTANT(ALCOHOL_NEGATIVE)    SETCONSTANT(ALCOHOL_NEUTRAL)	SETCONSTANT(ALCOHOL_POSITIVE)	#undef SETCONSTANT    lua_pop(L, 1);    assert(top == lua_gettop(L));}dmExtension::Result AppInitializeAppodeal(dmExtension::AppParams* params) {    return dmExtension::RESULT_OK;}dmExtension::Result InitializeAppodeal(dmExtension::Params* params) {    LuaInit(params->m_L);    printf("Registered %s Extension\n", MODULE_NAME);    return dmExtension::RESULT_OK;}dmExtension::Result AppFinalizeAppodeal(dmExtension::AppParams* params) {    return dmExtension::RESULT_OK;}dmExtension::Result FinalizeAppodeal(dmExtension::Params* params) {    return dmExtension::RESULT_OK;}DM_DECLARE_EXTENSION(Appodeal, LIB_NAME, AppInitializeAppodeal, AppFinalizeAppodeal, InitializeAppodeal, 0, 0, FinalizeAppodeal)